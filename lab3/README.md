Полурабочий если честно последний код

Тут в первой части через таблицы истинности расписываем что видим, ищем закономерности, пишем формулу и потом программируем. 
Есть комбинационная логика, выход зависит напрямую от входа. Есть последовательная логика, там учитываются задержки, всё идёт по тактам. Хотя всё равно в некоторых пунктах последовательных схем один из выходов был чисто комбинационной логикой. Важное замечание: тестбенч при последовательной логике должен использовать неблокирующее присваивание (<=).
Вторая часть -- конечные автоматы. У меня там как раз не реализованы состояния, а логика и состояния намешаны. Т.е. 3 и 4 части надо переделать.